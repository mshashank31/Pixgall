/* ======================================================= 
 * Auto Grid Responsive Gallery
 * By David Blanco
 *
 * Contact: http://codecanyon.net/user/davidbo90
 *
 * Created: June 6, 2013
 *
 * Copyright (c) 2013, David Blanco. All rights reserved.
 * Released under CodeCanyon License http://codecanyon.net/
 *
 * Note: Script based in jQuery Masonry v2.1.07 made by David DeSandro http://masonry.desandro.com/ (under MIT)
 *
 * ======================================================= */

/*!
 * imagesLoaded PACKAGED v3.0.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
;
/*!
 * EventEmitter v4.2.4 - git.io/ee
 * Oliver Caldwell
 * MIT license
 * @preserve
 */
(function(){function N(){}var E=N.prototype;function I(b,a){var c=b.length;while(c--){if(b[c].listener===a){return c}}return -1}function G(b){return function a(){return this[b].apply(this,arguments)}}E.getListeners=function w(c){var d=this._getEvents();var b;var a;if(typeof c==="object"){b={};for(a in d){if(d.hasOwnProperty(a)&&c.test(a)){b[a]=d[a]}}}else{b=d[c]||(d[c]=[])}return b};E.flattenListeners=function y(a){var c=[];var b;for(b=0;b<a.length;b+=1){c.push(a[b].listener)}return c};E.getListenersAsObject=function L(c){var a=this.getListeners(c);var b;if(a instanceof Array){b={};b[c]=a}return b||a};E.addListener=function K(c,e){var a=this.getListenersAsObject(c);var d=typeof e==="object";var b;for(b in a){if(a.hasOwnProperty(b)&&I(a[b],e)===-1){a[b].push(d?e:{listener:e,once:false})}}return this};E.on=G("addListener");E.addOnceListener=function P(b,a){return this.addListener(b,{listener:a,once:true})};E.once=G("addOnceListener");E.defineEvent=function A(a){this.getListeners(a);return this};E.defineEvents=function z(b){for(var a=0;a<b.length;a+=1){this.defineEvent(b[a])}return this};E.removeListener=function O(c,d){var e=this.getListenersAsObject(c);var b;var a;for(a in e){if(e.hasOwnProperty(a)){b=I(e[a],d);if(b!==-1){e[a].splice(b,1)}}}return this};E.off=G("removeListener");E.addListeners=function D(b,a){return this.manipulateListeners(false,b,a)};E.removeListeners=function x(b,a){return this.manipulateListeners(true,b,a)};E.manipulateListeners=function J(c,b,e){var g;var a;var f=c?this.removeListener:this.addListener;var d=c?this.removeListeners:this.addListeners;if(typeof b==="object"&&!(b instanceof RegExp)){for(g in b){if(b.hasOwnProperty(g)&&(a=b[g])){if(typeof a==="function"){f.call(this,g,a)}else{d.call(this,g,a)}}}}else{g=e.length;while(g--){f.call(this,b,e[g])}}return this};E.removeEvent=function B(c){var d=typeof c;var a=this._getEvents();var b;if(d==="string"){delete a[c]}else{if(d==="object"){for(b in a){if(a.hasOwnProperty(b)&&c.test(b)){delete a[b]}}}else{delete this._events}}return this};E.removeAllListeners=G("removeEvent");E.emitEvent=function v(d,b){var a=this.getListenersAsObject(d);var g;var e;var f;var c;for(f in a){if(a.hasOwnProperty(f)){e=a[f].length;while(e--){g=a[f][e];if(g.once===true){this.removeListener(d,g.listener)}c=g.listener.apply(this,b||[]);if(c===this._getOnceReturnValue()){this.removeListener(d,g.listener)}}}}return this};E.trigger=G("emitEvent");E.emit=function F(b){var a=Array.prototype.slice.call(arguments,1);return this.emitEvent(b,a)};E.setOnceReturnValue=function H(a){this._onceReturnValue=a;return this};E._getOnceReturnValue=function C(){if(this.hasOwnProperty("_onceReturnValue")){return this._onceReturnValue}else{return true}};E._getEvents=function M(){return this._events||(this._events={})};if(typeof define==="function"&&define.amd){define(function(){return N})}else{if(typeof module==="object"&&module.exports){module.exports=N}else{this.EventEmitter=N}}}.call(this));
/*!
 * eventie v1.0.3
 * event binding helper
 *   eventie.bind( elem, 'click', myFn )
 *   eventie.unbind( elem, 'click', myFn )
 */
(function(i){var g=document.documentElement;var h=function(){};if(g.addEventListener){h=function(a,b,c){a.addEventListener(b,c,false)}}else{if(g.attachEvent){h=function(a,b,c){a[b+c]=c.handleEvent?function(){var d=i.event;d.target=d.target||d.srcElement;c.handleEvent.call(c,d)}:function(){var d=i.event;d.target=d.target||d.srcElement;c.call(a,d)};a.attachEvent("on"+b,a[b+c])}}}var j=function(){};if(g.removeEventListener){j=function(a,b,c){a.removeEventListener(b,c,false)}}else{if(g.detachEvent){j=function(a,c,d){a.detachEvent("on"+c,a[c+d]);try{delete a[c+d]}catch(b){a[c+d]=undefined}}}}var f={bind:h,unbind:j};if(typeof define==="function"&&define.amd){define(f)}else{i.eventie=f}})(this);
/*!
 * imagesLoaded v3.0.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
(function(m){var o=m.jQuery;var p=m.console;var r=typeof p!=="undefined";function l(b,c){for(var a in c){b[a]=c[a]}return b}var j=Object.prototype.toString;function n(a){return j.call(a)==="[object Array]"}function q(a){var b=[];if(n(a)){b=a}else{if(typeof a.length==="number"){for(var c=0,d=a.length;c<d;c++){b.push(a[c])}}else{b.push(a)}}return b}function k(a,c){function b(g,h,i){if(!(this instanceof b)){return new b(g,h)}if(typeof g==="string"){g=document.querySelectorAll(g)}this.elements=q(g);this.options=l({},this.options);if(typeof h==="function"){i=h}else{l(this.options,h)}if(i){this.on("always",i)}this.getImages();if(o){this.jqDeferred=new o.Deferred()}var f=this;setTimeout(function(){f.check()})}b.prototype=new a();b.prototype.options={};b.prototype.getImages=function(){this.images=[];for(var i=0,x=this.elements.length;i<x;i++){var h=this.elements[i];if(h.nodeName==="IMG"){this.addImage(h)}var f=h.querySelectorAll("img");for(var v=0,g=f.length;v<g;v++){var w=f[v];this.addImage(w)}}};b.prototype.addImage=function(g){var f=new e(g);this.images.push(f)};b.prototype.check=function(){var f=this;var u=0;var h=this.images.length;this.hasAnyBroken=false;if(!h){this.complete();return}function i(s,t){if(f.options.debug&&r){p.log("confirm",s,t)}f.progress(s);u++;if(u===h){f.complete()}return true}for(var v=0;v<h;v++){var g=this.images[v];g.on("confirm",i);g.check()}};b.prototype.progress=function(g){this.hasAnyBroken=this.hasAnyBroken||!g.isLoaded;var f=this;setTimeout(function(){f.emit("progress",f,g);if(f.jqDeferred){f.jqDeferred.notify(f,g)}})};b.prototype.complete=function(){var g=this.hasAnyBroken?"fail":"done";this.isComplete=true;var f=this;setTimeout(function(){f.emit(g,f);f.emit("always",f);if(f.jqDeferred){var h=f.hasAnyBroken?"reject":"resolve";f.jqDeferred[h](f)}})};if(o){o.fn.imagesLoaded=function(g,f){var h=new b(this,g,f);return h.jqDeferred.promise(o(this))}}var d={};function e(f){this.img=f}e.prototype=new a();e.prototype.check=function(){var g=d[this.img.src];if(g){this.useCached(g);return}d[this.img.src]=this;if(this.img.complete&&this.img.naturalWidth!==undefined){this.confirm(this.img.naturalWidth!==0,"naturalWidth");return}var f=this.proxyImage=new Image();c.bind(f,"load",this);c.bind(f,"error",this);f.src=this.img.src};e.prototype.useCached=function(g){if(g.isConfirmed){this.confirm(g.isLoaded,"cached was confirmed")}else{var f=this;g.on("confirm",function(h){f.confirm(h.isLoaded,"cache emitted confirmed");return true})}};e.prototype.confirm=function(g,f){this.isConfirmed=true;this.isLoaded=g;this.emit("confirm",this,f)};e.prototype.handleEvent=function(g){var f="on"+g.type;if(this[f]){this[f](g)}};e.prototype.onload=function(){this.confirm(true,"onload");this.unbindProxyEvents()};e.prototype.onerror=function(){this.confirm(false,"onerror");this.unbindProxyEvents()};e.prototype.unbindProxyEvents=function(){c.unbind(this.proxyImage,"load",this);c.unbind(this.proxyImage,"error",this)};return b}if(typeof define==="function"&&define.amd){define(["eventEmitter/EventEmitter","eventie/eventie"],k)}else{m.imagesLoaded=k(m.EventEmitter,m.eventie)}})(window);(function(d,e,f){var b=e.event,a=e.event.handle?"handle":"dispatch",c;b.special.smartresize={setup:function(){e(this).bind("resize",b.special.smartresize.handler)},teardown:function(){e(this).unbind("resize",b.special.smartresize.handler)},handler:function(j,g){var i=this,h=arguments;j.type="smartresize";if(c){clearTimeout(c)}c=setTimeout(function(){b[a].apply(i,h)},g==="execAsap"?0:100)}};e.fn.smartresize=function(g){return g?this.bind("smartresize",g):this.trigger("smartresize",["execAsap"])};e.Mason=function(g,h){this.element=e(h);this._create(g);this._init()};e.Mason.settings={isResizable:true,isAnimated:false,animationOptions:{queue:false,duration:500,complete:function(){var g=e(this);if(!g.hasClass("grid-brick")){if(e.fn.grid.defaults.lazyLoad){e.waypoints("refresh")}if(g.hasClass("grid-with-loading-boxes")){g.removeClass("grid-with-loading-boxes");g.addClass("completeAddingImages")}}}},gutterWidth:0,isRTL:false,isFitWidth:false,containerStyle:{position:"relative"}};e.Mason.prototype={_resized:false,_filterFindBricks:function(h){var g=this.options.itemSelector;return !g?h:h.filter(g).add(h.find(g))},_getBricks:function(h){var g=this._filterFindBricks(h).css({position:"absolute"}).addClass("grid-brick");return g},_create:function(j){this.options=e.extend(true,{},e.Mason.settings,j);this.styleQueue=[];var i=this.element[0].style;this.originalStyle={height:i.height||""};var k=this.options.containerStyle;for(var m in k){this.originalStyle[m]=i[m]||""}this.element.css(k);this.horizontalDirection=this.options.isRTL?"right":"left";var h=this.element.css("padding-"+this.horizontalDirection);var l=this.element.css("padding-top");this.offset={x:h?parseInt(h,10):0,y:l?parseInt(l,10):0};this.isFluid=this.options.columnWidth&&typeof this.options.columnWidth==="function";var g=this;setTimeout(function(){g.element.addClass("grid")},0);if(this.options.isResizable){e(d).bind("smartresize.grid",function(){g.resize()})}this.reloadItems()},_init:function(g){this._getColumns();this._reLayout(g)},option:function(g,h){if(e.isPlainObject(g)){this.options=e.extend(true,this.options,g)}},layout:function(s,w){for(var p=0,q=s.length;p<q;p++){this._placeBrick(s[p])}var g={};g.height=Math.max.apply(Math,this.colYs);if(this.options.isFitWidth){var n=0;p=this.cols;while(--p){if(this.colYs[p]!==0){break}n++}g.width=(this.cols-n)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:g});var j=!this.isLaidOut?"css":(this.options.isAnimated?"animate":"css"),m=this.options.animationOptions;var o;var l=false;for(p=0,q=this.styleQueue.length;p<q;p++){o=this.styleQueue[p];j=!this.isLaidOut?"css":(this.options.isAnimated?"animate":"css");var r=o.$el.hasClass("loading-box");if(r&&!this.element.hasClass("noSupportTransform")){j="css";l=true}else{if(l){o.$el.css(o.style,m)}}o.$el.removeClass("loading-box");var k=o.$el.css("left");var u=o.$el.css("top");var v=o.style.left+"px";var t=o.style.top+"px";if((k==v&&u==t)||r==true){o.$el.data("moving",false)}else{o.$el.data("moving",true)}var h=500;o.$el[j](o.style,m)}this.styleQueue=[];if(w){w.call(s)}this.isLaidOut=true},_getColumns:function(){var g=this.options.isFitWidth?this.element.parent():this.element,h=g.width();this.columnWidth=this.isFluid?this.options.columnWidth(h):this.options.columnWidth||this.$bricks.outerWidth(true)||h;this.columnWidth+=this.options.gutterWidth;this.cols=Math.floor((h+this.options.gutterWidth)/this.columnWidth);this.cols=Math.max(this.cols,1)},_placeBrick:function(p){var n=e(p),r,v,k,t,l;r=Math.ceil(n.outerWidth(true)/this.columnWidth);r=Math.min(r,this.cols);if(r===1){k=this.colYs}else{v=this.cols+1-r;k=[];for(l=0;l<v;l++){t=this.colYs.slice(l,l+r);k[l]=Math.max.apply(Math,t)}}var g=Math.min.apply(Math,k),u=0;for(var m=0,q=k.length;m<q;m++){if(k[m]===g){u=m;break}}var o={top:g+this.offset.y};o[this.horizontalDirection]=this.columnWidth*u+this.offset.x;this.styleQueue.push({$el:n,style:o});var s=g+n.outerHeight(true),h=this.cols+1-q;for(m=0;m<h;m++){this.colYs[u+m]=s}},resize:function(){var g=this.cols;this._getColumns();if(this.isFluid||this.cols!==g){this._reLayout()}},_reLayout:function(h){var g=this.cols;this.colYs=[];while(g--){this.colYs.push(0)}this.layout(this.$bricks,h)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(g){this.reloadItems();this._init(g)},appended:function(h,i,j){if(i){this._filterFindBricks(h).css({top:this.element.height()});var g=this;setTimeout(function(){g._appended(h,j)},1)}else{this._appended(h,j)}},_appended:function(g,i){var h=this._getBricks(g);this.$bricks=this.$bricks.add(h);this.layout(h,i)},remove:function(g){this.$bricks=this.$bricks.not(g);g.remove()},destroy:function(){this.$bricks.removeClass("grid-brick").each(function(){this.style.position="";this.style.top="";this.style.left=""});var g=this.element[0].style;for(var h in this.originalStyle){g[h]=this.originalStyle[h]}this.element.unbind(".grid").removeClass("grid").removeData("grid");e(d).unbind(".grid")}};e.fn.grid=function(i){var g=function(x){var F=e.extend({},e.fn.grid.defaults,i);if(F.visibleCaption){F.caption=false}if(i!=f&&i.lazyLoad!=f){e.fn.grid.defaults.lazyLoad=i.lazyLoad}if(i==f){i={}}i.isFitWidth=F.isFitWidth;i.isAnimated=F.isAnimated;i.itemSelector=".gbox";i.gutterWidth=F.horizontalSpaceBetweenThumbnails;var t=e(x).addClass("centered").addClass("grid-clearfix");var K=F.columnWidth;if(K=="auto"){i.columnWidth=function(ax){var ay=-999;for(var aw=F.columns;aw>=1;aw--){if(ay<F.columnMinWidth){ay=(((ax-(aw-1)*i.gutterWidth)/aw)|0)}}t.find("div.gbox").width(ay);return ay}}else{if((typeof K)!="function"){i.columnWidth=function(aw){var ax=K;t.find("div.gbox").width(ax);return ax}}}t.find("div.gbox").css("margin-bottom",F.verticalSpaceBetweenThumbnails);var af=(function(){var ay=document.createElement("div"),ax="Khtml ms O Moz Webkit".split(" "),aw=ax.length;return function(az){if(az in ay.style){return true}az=az.replace(/^[a-z]/,function(aA){return aA.toUpperCase()});while(aw--){if(ax[aw]+az in ay.style){return true}}return false}})();if(!af("transform")){t.addClass("noSupportTransform")}else{t.addClass("visible")}var O=null;var ar=t.data("directory");var D=e('<ul class="category-navbar" />').hide().insertBefore(t);var ao=function(){var aw=D.find("li[class=select]").data("category");return aw};var aq=e("<div />").insertAfter(t);var J=function(){aq.addClass("grid-loader").removeClass("grid-loadMore").html("")};var U=function(){aq.removeClass("grid-loader")};var Q=false;var q=function(aA){var ax=0;for(var az in O){var aw=O[az];if(aA==az||aA=="all"){for(var ay in aw){ax++}}}if(ax>0){Q=false;return true}else{return false}};var u=function(aw){if(aw){aq.addClass("grid-loadMore").html("LOAD MORE IMAGES")}else{aq.removeClass("grid-loadMore").html("")}};var E=function(az,aI,aw){var aH="thumbnails/";if(aw=="no"){aH=""}var ax=az+"/";if(az=="all"){ax=""}var aC=aI.split(/\.(?=[^.]*$)/)[0];var aB="<h5>In "+az+"</h5>";if(az=="all"||F.captionCategory==false){aB=""}var ay="";if(aC.indexOf("$$")!=-1){var aF=aC.split("$$");aC=aF[0];var aG=aF[1].split(":").join("/");aG=aG.split("|").join("/");ay='data-url="'+aG+'"'}if(aC.substr(1,1)=="-"){aC=aC.substr(2)}var aA="";var aD="";if(F.visibleCaption){aA="visible-caption"}var aE='<div class="gbox" data-category="'+az+'" '+ay+'><img src="'+ar+"/"+ax+aH+aI+'" data-lightbox="'+ar+"/"+ax+aI+'" /><div class="image-caption '+aA+'"><h3>'+aC+"</h3>"+aB+'</div><div class="lightbox-text">'+aC+" <span>In "+az+"</span></div></div>";return aE};var k=function(){var aw=ao();if(aw!="all"){t.children("div").not('.gbox[data-category="'+aw+'"]').removeClass("gbox grid-brick").hide()}};var j=function(aw){aw=e(aw).addClass("loading-box");aw.css("margin-bottom",F.verticalSpaceBetweenThumbnails);t.append(aw.hide());t.imagesLoaded(function(){aw.hide();k();t.addClass("grid-with-loading-boxes");t.grid("reload");var ax=[];ax.push(aw);ah(ax,[]);U();u(q(ao()));Q=false})};var L=function(az){var ay=[];var aw=Array();for(var ax in az){if(az.hasOwnProperty(ax)){ay.push(az[ax].order.toLowerCase()+"-&$&$-"+ax)}}ay.sort();if(F.imagesOrder=="byName"||F.imagesOrder=="byDateReverse"){}else{ay.reverse()}jQuery.each(ay,function(aC,aB){var aA=aB.split("-&$&$-");aA=aA[1];aw.push(az[aA])});return aw};var r=function(ay){J();var aF=0;for(var aH in O){var aw=O[aH];var ax=0;for(var aB in aw){ax++}if(ax>aF){aF=ax}}var aE=new Array();if(F.aleatoryImagesFromCategories){for(var aA=0;aA<aF;aA++){var aJ=0;for(var aH in O){aw=O[aH];var aI=aH;if(aJ==0){aI="all"}var aG=0;for(var aB in aw){if(aG==aA){aE.push({category:aI,image:aB,thumb:aw[aB].thumb,order:aw[aB].order,categoryOriginal:aH});break}aG++}aJ++}}}else{var aJ=0;for(var aH in O){var aw=O[aH];var aI=aH;if(aJ==0){aI="all"}for(var aB in aw){aE.push({category:aI,image:aB,thumb:aw[aB].thumb,order:aw[aB].order,categoryOriginal:aH})}aJ++}}if(F.orderInAll&&F.imagesOrder!="random"){aE=L(aE)}var aD="";var aC=0;while(aC<ay){if(aC>=aE.length){break}var az=aE[aC];aD+=E(az.category,az.image,az.thumb);delete O[az.categoryOriginal][az.image];aC++}j(aD)};var ad=function(ax,aE){J();var aC=new Array();var aG=0;for(var aD in O){var aw=O[aD];var aF=aD;if(aG==0){aF="all"}if(aF==aE){for(var az in aw){aC.push({category:aF,image:az,thumb:aw[az].thumb,order:aw[az].order,categoryOriginal:aD})}}aG++}if(F.orderInAll&&F.imagesOrder!="random"){aC=L(aC)}var aB="";var aA=0;while(aA<ax){if(aA>=aC.length){break}var ay=aC[aA];aB+=E(ay.category,ay.image,ay.thumb);delete O[ay.categoryOriginal][ay.image];aA++}j(aB)};var ap=function(){if(aq.hasClass("grid-loadMore")){var aw=ao();if(aw=="all"){r(F.imagesToLoad)}else{ad(F.imagesToLoad,aw)}}};aq.on("click",function(){ap()});if(F.lazyLoad){aq.waypoint(function(ax){var aw=t;if(aw.hasClass("completeAddingImages")){if(aq.hasClass("grid-loadMore")){ap();aw.removeClass("completeAddingImages")}}},{context:d,continuous:true,enabled:true,horizontal:false,offset:"bottom-in-view",triggerOnce:false})}var w=function(){var aw=0;for(var ax in O){var ay=ax;if(ay.substr(1,1)=="-"){ay=ay.substr(2)}var az=e("<li />").data("category",ax).appendTo(D);e("<a />").html(ay).appendTo(az);if(aw==0){az.addClass("select");az.data("category","all")}aw++}if(F.smartNavBar&&aw<=2){F.showNavBar=false}if(F.showNavBar){D.slideDown(400)}};var ah=function(ax,ay){for(var aw=0;aw<ax.length;aw++){ax[aw].each(function(){var az=e(this).removeClass("noTransform");if(az.hasClass("grid-brick")){if(az.is(":hidden")){if(t.hasClass("noSupportTransform")){az.show()}else{az.show();if(az.data("moving")==false){az.animate(F.hiddenStyle,0);az.animate(F.visibleStyle,400,function(){az.addClass("noTransform")})}else{az.animate(F.visibleStyle,0);az.addClass("noTransform")}}}else{az.animate(F.visibleStyle,i.animOpts,function(){az.addClass("noTransform")})}}})}for(var aw=0;aw<ay.length;aw++){ay[aw].each(function(){var az=e(this).removeClass("noTransform");if(az.is(":hidden")==false){az.addClass("box");if(t.hasClass("noSupportTransform")){az.hide();az.removeClass("box")}else{az.animate(F.visibleStyle,0);az.animate(F.hiddenStyle,i.animOpts,function(){az.hide();az.removeClass("box")})}}else{}})}};e.getJSON("reader.php?directory="+ar+"&categoriesOrder="+F.categoriesOrder+"&imagesOrder="+F.imagesOrder,function(aw){O=aw;if(jQuery.isArray(aw.All)){aw.All={}}D.css("display","none");w();r(F.imagesToLoadStart)});D.on("click","a",function(aE){aE.preventDefault();var aB=jQuery(this);if(aB.parent("li").hasClass("select")){return}t.removeClass("completeAddingImages");t.addClass("grid-with-loading-boxes");aB.parent("li").addClass("select").siblings("li").removeClass("select");var ay=t;var ax=aB.parent("li").data("category");var aC=[];var az=[];if(ax=="all"){var aD=ay.children("div").addClass("gbox grid-brick");if(t.hasClass("noSupportTransform")){aD.css({top:200,left:200})}aC.push(aD)}else{var aw=ay.children('div[data-category="'+ax+'"]').addClass("gbox grid-brick");if(aw[0]!=f){if(t.hasClass("noSupportTransform")){aw.css({top:200,left:200})}aC.push(aw.stop())}var aA=ay.children("div").not('.gbox[data-category="'+ax+'"]').removeClass("gbox grid-brick");az.push(aA)}t.grid("reload");ah(aC,az);u(q(ao()))});t.on("mouseenter.hoverdir, mouseleave.hoverdir","div.gbox",function(aB){if(!F.caption){return}var az=e(this),aA=aB.type,ay=az.find("div.image-caption"),aC=m(az,{x:aB.pageX,y:aB.pageY}),ax=al(aC,az);var aD=ay.children("div.aligment");if(aD[0]==f){var aw=ay.html();ay.html("<div class='aligment'><div class='aligment'>"+aw+"</div></div>")}if(aA==="mouseenter"){if(F.captionType=="classic"){ay.css({left:0,top:0});ay.fadeIn(300);return}ay.css({left:ax.from,top:ax.to});ay.stop().show().fadeTo(0,1,function(){e(this).stop().animate({top:0,left:0},200,"linear")})}else{if(F.captionType=="classic"){ay.css({left:0,top:0});ay.fadeOut(300);return}if(F.captionType=="grid-fade"){ay.fadeOut(700)}else{ay.stop().animate({left:ax.from,top:ax.to},200,"linear",function(){ay.hide()})}}});var m=function(ay,aB){var ax=ay.width(),az=ay.height(),aw=(aB.x-ay.offset().left-(ax/2))*(ax>az?(az/ax):1),aC=(aB.y-ay.offset().top-(az/2))*(az>ax?(ax/az):1),aA=Math.round((((Math.atan2(aC,aw)*(180/Math.PI))+180)/90)+3)%4;return aA};var al=function(ay,ax){var az,aw;switch(ay){case 0:if(!F.reverse){az=0,aw=-ax.height()}else{az=0,aw=-ax.height()}break;case 1:if(!F.reverse){az=ax.width(),aw=0}else{az=-ax.width(),aw=0}break;case 2:if(!F.reverse){az=0,aw=ax.height()}else{az=0,aw=-ax.height()}break;case 3:if(!F.reverse){az=-ax.width(),aw=0}else{az=ax.width(),aw=0}break}return{from:az,to:aw}};var Y=e("body");var aj={interval:"none"};var o=0;var R=e('<div class="autoGrid-lightbox" />').appendTo(Y);var X=e('<div class="autoGrid-nav" />').appendTo(R);var aa=e('<div class="autoGrid-close" />').appendTo(X);var V=e('<i class="iconClose" />').appendTo(aa);var z=e('<div class="autoGrid-play" />');if(F.lightboxPlayBtn){z.appendTo(X)}var G=e('<i class="iconPlay" />').appendTo(z);var ag=e('<div class="autoGrid-lbcaption" />').appendTo(X).html("Here will go the text for the lightbox");var am=e('<div class="autoGrid-next" />').appendTo(X);var au=e('<i class="iconNext" />').appendTo(am);var C=e('<div class="autoGrid-prev" />').appendTo(X);var I=e('<i class="iconPrev" />').appendTo(C);var ae=e('<div class="lightbox-timer" />').appendTo(R);var s=aa.width();var Z=3;if(F.lightboxPlayBtn){Z=4}var l=function(){var az=R.outerWidth();if(az<650){ag.hide();am.css("width",(az/Z));C.css("width",(az/Z));z.css("width",(az/Z));aa.css("width",az-((az/Z)*(Z-1)))}else{ag.show();am.css("width",s);C.css("width",s);z.css("width",s);aa.css("width",s)}var aw=R.find("img");var ay=R.outerHeight()-X.outerHeight();aw.css("max-height",ay);var ax=R.find("iframe");var ay=R.outerHeight()-X.outerHeight();if(ay!=0){ax.css("max-height",ay)}else{ax.css("max-height","none")}};jQuery(d).resize(function(){l()});var T=new Image();var W=function(){if(T!=null){T.onload=null;T=null}R.find(".lightbox-alignment").remove();R.find(".lightbox-alignment2").remove();R.find("img").remove()};var p=function(){R.find("iframe").remove()};var N=function(){R.find(".lb-loader").remove()};var B=function(){R.append('<div class="lb-loader"/>')};R.attr("unselectable","on").css("user-select","none").on("selectstart",false);var M=function(){ae.stop(true,true).width(0)};var at=function(){clearInterval(aj.interval)};var A=function(){if(F.lightBoxShowTimer==false){return}ae.css({position:"absolute",bottom:0}).animate({width:"100%"},F.lightBoxPlayInterval,"linear",function(){M()})};var av=false;var ac=false;var P=function(){aj.interval=setTimeout(function(){n()},F.lightBoxPlayInterval);A()};var y=function(){if(av&&ac==false){M();at();P()}};var v=function(ax){var aw=e('<iframe src="'+ax+'" class="lightbox-iframe" width="100%" height="100%" frameborder="0" allowfullscreen></iframe>');R.append(aw.hide());var ay=aw[0];if(ay.attachEvent){ay.attachEvent("onload",function(){N();aw.fadeIn(F.lightBoxSpeedFx,function(){y()});l();T=new Image()})}else{ay.onload=function(){N();aw.fadeIn(F.lightBoxSpeedFx,function(){y()});l();T=new Image()}}};var ak=e("<span />");var H=function(aC,ax){p();W();N();B();var aA=0;var aB=0;if(ax!=true){aA=0.9;aB=F.lightBoxSpeedFx}if(F.lightBoxZoomAnim==false){aA=1}var ay=aC;var az=ay.data("lightbox");if(az==f){az=ay.attr("src")}var aH=ay.siblings("div.lightbox-text").html();if(F.lightBoxText==false){aH=""}var aF="<div><div>"+aH+"</div></div>";ag.html(aF);var aG="";for(var aE in F.videos){if(az==ar+"/"+aE){aG=F.videos[aE];break}}if(aG!=""){v(aG);return}T=new Image();var aw=e(T);var aD=T;T.onload=function(){if(aD!=T){return}N();var aJ=e('<div class="lightbox-alignment"></div>').appendTo(R);var aI=e('<div class="lightbox-alignment2"></div>').appendTo(aJ);aI.append(aw.css("margin-top",-X.outerHeight()).hide().scale(aA));aw.fadeIn(aB).animate({scale:"1"},{duration:F.lightBoxSpeedFx,complete:function(){y()}});l()};T.src=az;ak.stop(true);ak=e(T)};var an=false;var ab="";t.on("click","div.gbox",function(){an=true;var ay=e(this);var ax=ay.data("url");ab="";if(ax!=f&&F.linkOnLightbox==true){ab="http://"+ax}else{if(ax!=f){d.location.href="http://"+ax;return}}if(F.lightBox==false){return}ac=false;o=t.find(".gbox").index(this);var aw=ay.children("img");X.animate({"margin-top":0},F.lightBoxSpeedFx);R.fadeIn(F.lightBoxSpeedFx);H(aw,true)});R.on("click","div",function(aw){aw.stopPropagation()});R.on("click","img",function(aw){aw.stopPropagation()});R.on("click",".lightbox-alignment",function(){ai()});R.on("click",".lightbox-alignment2",function(){ai()});R.on("click",function(){ai()});aa.on("click",function(){ai()});var ai=function(){p();if(F.lightBoxStopPlayOnClose){z.removeClass("selected");av=false}an=false;ac=true;M();at();R.find(".lb-loader").remove();var ax=0;if(F.lightBoxZoomAnim==false){ax=1}var aw=R.find("img").stop().show();X.animate({"margin-top":-X.outerHeight()},F.lightBoxSpeedFx);if(aw[0]!=f){aw.animate({scale:ax},F.lightBoxSpeedFx,function(){R.fadeOut(100)})}else{R.fadeOut(100)}};var n=function(){ac=false;var aA=t.find(".gbox");o+=1;if(o>=aA.length){o=0}if(!aA.eq(o).is(":visible")){var aw=o;for(var az=0;az<aA.length;az++){aw++;if(aw>=aA.length){aw=0}if(aA.eq(aw).is(":visible")){o=aw;break}}}var ax=aA.eq(o).children("img");var ay=aA.eq(o).data("url");ab="";if(ay!=f&&F.linkOnLightbox==true){ab="http://"+ay}H(ax)};var S=function(){ac=false;var aA=t.find(".gbox");o-=1;if(o<0){o=aA.length-1}if(!aA.eq(o).is(":visible")){var aw=o;for(var az=0;az<aA.length;az++){aw--;if(aw<0){aw=aA.length-1}if(aA.eq(aw).is(":visible")){o=aw;break}}}var ax=aA.eq(o).children("img");var ay=aA.eq(o).data("url");ab="";if(ay!=f&&F.linkOnLightbox==true){ab="http://"+ay}H(ax)};am.on("click",function(){M();at();n()});R.on("click","img",function(){if(ab==""){M();at();n()}else{location.href=ab}});C.on("click",function(){M();at();S()});e(document).keyup(function(aw){if(!F.lightboxKeyboardNav){return}if(aw.keyCode=="37"){if(an==false){return}M();at();S()}if(aw.keyCode=="39"){if(an==false){return}M();at();n()}if(aw.keyCode==27){ai()}});if(F.lightBoxAutoPlay){z.addClass("selected");av=true}z.on("click",function(){x=e(this);if(x.hasClass("selected")){x.removeClass("selected");av=false;M();at()}else{x.addClass("selected");av=true;P()}})};if(typeof i==="string"){var h=Array.prototype.slice.call(arguments,1);this.each(function(){var j=e.data(this,"grid");if(!j){logError("cannot call methods on grid prior to initialization; attempted to call method '"+i+"'");return}if(!e.isFunction(j[i])||i.charAt(0)==="_"){logError("no such method '"+i+"' for grid instance");return}j[i].apply(j,h)})}else{this.each(function(){var j=e.data(this,"grid");if(j){j.option(i||{});j._init()}else{g(this);e.data(this,"grid",new e.Mason(i,this))}})}return this};e.fn.grid.defaults={categoriesOrder:"byName",imagesOrder:"byDate",orderInAll:false,isFitWidth:true,lazyLoad:true,showNavBar:true,smartNavBar:true,imagesToLoadStart:15,imagesToLoad:5,aleatoryImagesFromCategories:true,horizontalSpaceBetweenThumbnails:5,verticalSpaceBetweenThumbnails:5,columnWidth:"auto",columns:5,columnMinWidth:220,isAnimated:true,caption:true,captionCategory:true,captionType:"grid",lightBox:true,lightboxKeyboardNav:true,lightBoxSpeedFx:500,lightBoxZoomAnim:true,lightBoxText:true,lightboxPlayBtn:true,lightBoxAutoPlay:false,lightBoxPlayInterval:4000,lightBoxShowTimer:true,lightBoxStopPlayOnClose:false,videos:{},linkOnLightbox:false,hiddenStyle:{opacity:0,scale:0.001},visibleStyle:{opacity:1,scale:1},visibleCaption:false}})(window,jQuery);
